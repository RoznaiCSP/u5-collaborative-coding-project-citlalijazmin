controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    otherSprite = sprites.createProjectileFromSprite(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . 2 2 2 2 2 2 2 2 2 2 2 2 . . 
        . . 3 3 3 3 3 3 3 3 3 3 3 3 . . 
        . . 1 1 1 1 1 1 1 1 1 1 1 1 . . 
        . . 1 1 1 1 1 1 1 1 1 1 1 1 . . 
        . . 3 3 3 3 3 3 3 3 3 3 3 3 . . 
        . . 2 2 2 2 2 2 2 2 2 2 2 2 . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, player1, 200, 0)
    lightningBolts.destroy(effects.spray, 500)
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Player, function (sprite, otherSprite) {
    game.splash("Hello  " + Name)
    pause(500)
    story.clearAllText()
    game.showLongText("Would you like to go on a quest?", DialogLayout.Bottom)
    pause(500)
    story.clearAllText()
    story.showPlayerChoices("ACCEPT", "DECLINE")
    if (story.checkLastAnswer("ACCEPT")) {
        game.showLongText("Do you want to take the challenge?", DialogLayout.Bottom)
        story.showPlayerChoices("YES", "NO")
        story.clearAllText()
        effects.clearParticles(player1)
        effects.clearParticles(Yor)
        story.clearAllText()
        game.splash("Press \"B\" to shoot")
        game.splash("Ready, GO!")
        story.clearAllText()
        sprites.destroyAllSpritesOfKind(SpriteKind.Player)
        tiles.setCurrentTilemap(tilemap`level2`)
        player1 = sprites.create(img`
            ......fffffffffffff..........
            .....f3333333333333f.........
            ffffff3333333333333ffffff....
            feee53333333333333335eeef....
            feeee333333333333333eeeef....
            fee5313333333333333135eef....
            .fee33133131131333133eef.....
            .fe5333311311313133335ef.....
            ..f3333333333333333333f......
            ..f3333333333333333333f......
            ..f33333f3333333f33333f......
            ..f3333fff3d3d3fff3333f......
            .ff333f161ddddd161f3333f.....
            .f333ff166ddddd661ff333f.....
            .f3333f167ddddd761f3333f.....
            f333333d77ddddd77d333333f....
            f333333eddddddddde333333f....
            f33333338ddddddd83333333f....
            .f3f33333811111833333f3f.....
            ..f.ff3388815188833ff.f......
            ......f38888888883f..........
            ......f88881518888f..........
            .....f1888888888881f.........
            ....f1d18881518881d1f........
            ....f118888888888811f........
            .....ff81188888118ff.........
            ......f88888888888f..........
            .......f888888888f...........
            ........fffffffff............
            ........f11fff11f............
            ........fffffffff............
            `, SpriteKind.Player)
        controller.moveSprite(player1, 200, 200)
        player1.setStayInScreen(true)
        info.setLife(1)
    } else if (story.checkLastAnswer("DECLINE")) {
        game.over(false)
    }
})
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Enemy, function (sprite, otherSprite) {
    otherSprite.destroy(effects.fire, 500)
    info.changeScoreBy(1)
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function (sprite, otherSprite) {
    game.gameOver(false)
    lightningBolts.destroy(effects.spray, 500)
})
let lightningBolts: Sprite = null
let otherSprite: Sprite = null
let Yor: Sprite = null
let player1: Sprite = null
let Name = ""
Name = game.askForString("Name your character")
tiles.setCurrentTilemap(tilemap`level1`)
player1 = sprites.create(img`
    ......fffffffffffff..........
    .....f3333333333333f.........
    ffffff3333333333333ffffff....
    feee53333333333333335eeef....
    feeee333333333333333eeeef....
    fee5313333333333333135eef....
    .fee33133131131333133eef.....
    .fe5333311311313133335ef.....
    ..f3333333333333333333f......
    ..f3333333333333333333f......
    ..f33333f3333333f33333f......
    ..f3333fff3d3d3fff3333f......
    .ff333f161ddddd161f3333f.....
    .f333ff166ddddd661ff333f.....
    .f3333f167ddddd761f3333f.....
    f333333d77ddddd77d333333f....
    f333333eddddddddde333333f....
    f33333338ddddddd83333333f....
    .f3f33333811111833333f3f.....
    ..f.ff3388815188833ff.f......
    ......f38888888883f..........
    ......f88881518888f..........
    .....f1888888888881f.........
    ....f1d18881518881d1f........
    ....f118888888888811f........
    .....ff81188888118ff.........
    ......f88888888888f..........
    .......f888888888f...........
    ........fffffffff............
    ........f11fff11f............
    ........fffffffff............
    `, SpriteKind.Player)
player1.setScale(1, ScaleAnchor.Right)
tiles.placeOnTile(player1, tiles.getTileLocation(7, 15))
Yor = sprites.create(img`
    .............................
    .........fffffff.............
    .......fffffffffff...........
    ......fff1111111fff..........
    .....fff111111111fff.........
    .....ff11fffffff11ff.........
    ....fff1fffffffff1fff........
    ....ff1fffffffffff1ff........
    ....ff1fffffffffff1ff........
    ....f1fffffffffffff1f........
    ...ff1ffcfffffffcff1ff.......
    ...ffffcccfffdfcccffff.......
    ...fffc121dffdd121cfff.......
    ...f5cc122ddddd221cc5f.......
    ....ffc12fdddddf21cff........
    .....ffdffdddddffdff.........
    .....ff33ddddddd33ff.........
    .....fffdddddddddfff.........
    .....ffffdddddddffff.........
    .....fffdd2ddd2ddfff.........
    .....fffd2222222dfff.........
    ......cf222222222fc..........
    .....c2222222222222c.........
    ....cdd22222222222ddc........
    ....cdd22222222222ddc........
    .....cc22222222222cc.........
    ......c22222222222c..........
    .......c222222222c...........
    ........cfffffffc............
    ........cdddcdddc............
    ........ccccccccc............
    `, SpriteKind.Player)
Yor.setScale(1.5, ScaleAnchor.Right)
tiles.placeOnTile(Yor, tiles.getTileLocation(1, 3))
scene.cameraFollowSprite(player1)
controller.moveSprite(player1)
game.onUpdateInterval(500, function () {
    if (story.checkLastAnswer("YES")) {
        lightningBolts = sprites.create(img`
            . . . . . . . . . . . . . . . . 
            . . . . . f f f f f f f . . . . 
            . . . . f 1 1 1 1 1 1 1 f . . . 
            . . . . f 1 1 1 1 1 1 f . . . . 
            . . . f 1 1 1 1 1 1 f . . . . . 
            . . . f 1 1 1 1 1 f . . . . . . 
            . . f 1 1 1 1 1 f f f . . . . . 
            . . f 1 1 1 1 1 1 1 1 f . . . . 
            . f 1 1 1 1 1 1 1 1 f . . . . . 
            . . f f f f 1 1 1 f . . . . . . 
            . . . . f 1 1 1 f . . . . . . . 
            . . . . f 1 1 f . . . . . . . . 
            . . . f 1 1 f . . . . . . . . . 
            . . . f 1 f . . . . . . . . . . 
            . . . . f . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `, SpriteKind.Enemy)
        lightningBolts.setVelocity(-100, 0)
        lightningBolts.setPosition(160, randint(0, 120))
    } else if (story.checkLastAnswer("NO")) {
        game.over(false)
    }
})
